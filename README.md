# **mbox-rag**

`mbox-rag` is a Python-based tool for extracting and searching through emails stored in `.mbox` files using semantic similarity. This project uses embeddings generated by Sentence Transformers and FAISS for efficient similarity search, allowing users to query their email archive for the most relevant results.

## Usage

### 1. Extract and Index Emails

Place your `.mbox` file in the specified path (`mail.mbox/mbox`). Run the script to extract emails, generate embeddings, and create a FAISS index:

```bash
python parse_mbox.py
```

### 2. Query Emails

After the FAISS index is created, the script provides a real-time CLI for querying emails. Enter a query (e.g., “Charles Schwab”) to search for relevant emails.

## How It Works

1. **Extract Emails**: Parses the `.mbox` file and extracts metadata and plain-text content.
2. **Preprocess and Chunk**: Cleans the email content and splits long emails into smaller chunks.
3. **Generate Embeddings**: Creates semantic embeddings for each chunk using Sentence Transformers.
4. **FAISS Indexing**: Normalizes embeddings and adds them to a FAISS index for fast similarity search.
5. **Querying**: Accepts user input, generates a query embedding, and retrieves top matches from the FAISS index.

## Example

```bash
$ python parse_mbox.py
Extracting emails from mbox file.
Extracted 29 emails.
Generating embeddings for emails.
Loading embedding model: all-MiniLM-L6-v2
Generating embeddings for 114 chunks...
Processing batch 1/4
Processing batch 2/4
Processing batch 3/4
Processing batch 4/4
Embeddings generated successfully.
Creating FAISS index.
FAISS index created and embeddings added.
Enter your query below (type 'exit' to quit):
Query: Charles Schwab
Found:
Email 1 - Similarity: 0.85
Subject: Your Account Information
Sender: "Charles Schwab" <support@schwab.com>
Body Preview: Dear Cameron, your account summary is available for review...
```